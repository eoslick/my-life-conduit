package com.ses.mylifeconduit.corevalues.domain.event;

import com.ses.mylifeconduit.core.ddd.DomainEvent;
import com.ses.mylifeconduit.core.tenant.TenantId;
import com.ses.mylifeconduit.core.user.UserId;
import com.ses.mylifeconduit.corevalues.domain.vo.CoreValueId;
import com.ses.mylifeconduit.corevalues.domain.vo.CoreValueText;

import java.time.Instant;
import java.util.Objects;
import java.util.UUID;

/**
 * Event indicating a core value (system or custom) was selected by the user.
 */
public record CoreValueSelected(
        UUID eventId,
        UserId aggregateId,
        TenantId tenantId,
        long aggregateVersion,
        Instant occurredOn,
        // Event specific payload:
        CoreValueId coreValueId,
        CoreValueText coreValueText,
        boolean isCustom // Flag to indicate if the selected value was user-defined
) implements DomainEvent {

    public static final String EVENT_VERSION = "V1";

    /**
     * Canonical constructor validating inputs.
     */
    public CoreValueSelected {
        Objects.requireNonNull(eventId, "eventId cannot be null");
        Objects.requireNonNull(aggregateId, "aggregateId cannot be null");
        Objects.requireNonNull(tenantId, "tenantId cannot be null");
        if (aggregateVersion <= 0) throw new IllegalArgumentException("aggregateVersion must be positive");
        Objects.requireNonNull(occurredOn, "occurredOn cannot be null");
        Objects.requireNonNull(coreValueId, "coreValueId cannot be null");
        Objects.requireNonNull(coreValueText, "coreValueText cannot be null");
        // isCustom is a primitive boolean, no null check needed
    }

    @Override
    public String eventVersion() {
        return EVENT_VERSION;
    }
    // equals, hashCode, toString are generated by the record
}